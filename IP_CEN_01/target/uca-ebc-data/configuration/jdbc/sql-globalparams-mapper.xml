<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- See documentation @ http://mybatis.github.io/mybatis-3/sqlmap-xml.html -->

<mapper namespace="com.hp.uca.expert.globalparams.store.GlobalParamsDao">
	<resultMap id="globalparamsMap"
		type="com.hp.uca.expert.globalparams.store.StoredGlobalParams">
	</resultMap>

	<update id="createStore" parameterType="com.hp.uca.expert.store.sql.SqlStore">
		CREATE TABLE
		<if test="supportsIfNotExist">
			IF NOT EXISTS
		</if>
		GLOBALPARAMS (
		<choose>
			<when test="name != null and name.equals('sqlite')">
				identifier VARCHAR(200)PRIMARY KEY,
			</when>
			<when
				test="name != null and ( name.equals('hsqldb') or name.equals('h2') )">
				identifier VARCHAR(200) GENERATED BY DEFAULT AS IDENTITY(START
				WITH 1) NOT
				NULL PRIMARY KEY,
			</when>
			<otherwise>
			</otherwise>
		</choose>
		actionMode VARCHAR(100),
		actionType VARCHAR(100),
		activateGlobalParams
		CHAR(1),
		valuePackName VARCHAR(100)
		);
	</update>



	<insert id="storeGlobalParams"
		parameterType="com.hp.uca.expert.globalparams.store.StoredGlobalParams">
		INSERT INTO GLOBALPARAMS
		(
		actionMode,
		actionType,
		activateGlobalParams,
		valuePackName
		)
		VALUES
		(
		#{actionMode},
		#{actionType},
		#{activateGlobalParams},
		#{valuePackName}
		)
	</insert>


	<delete id="clearAll">
		DELETE FROM GLOBALPARAMS
	</delete>

	<delete id="deleteStore">
		DROP TABLE GLOBALPARAMS
	</delete>

	<select id="getGlobalParam" resultMap="globalparamsMap">
		SELECT
		*
		FROM
		GLOBALPARAMS
		WHERE
		identifier = #{identifier}
	</select>

	<select id="getGlobalParams" resultMap="globalparamsMap">
		SELECT
		*
		FROM
		GLOBALPARAMS
	</select>

	<select id="getGlobalParamsWithVP" resultMap="globalparamsMap">
		SELECT
		*
		FROM
		GLOBALPARAMS where valuepackname = #{param1}
	</select>

	
	<delete id="removeGlobalParam">
		DELETE FROM GLOBALPARAMS
		WHERE identifier =
		#{identifier}
	</delete>

	<update id="updateGlobalParams">
		UPDATE GLOBALPARAMS SET ACTIONMODE = #{param1},
		ACTIONTYPE =#{param2}, ACTIVATEGLOBALPARAMS = #{param3}
		WHERE
		identifier = #{param4}
	</update>



</mapper>